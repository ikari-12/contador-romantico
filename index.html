<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultado do Contador Romântico</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="resultado-container">
        <h1>Contador Romântico</h1>
        <p class="romantico">Juntos a cada segundo...</p>
        
        <!-- Exibição do contador -->
        <div id="resultado">
            <p id="contador">Carregando...</p>
            <img id="fotoImg" class="foto" src="" alt="Imagem Romântica">
        </div>
        
        <button onclick="window.history.back();">Voltar</button>
    </div>

    <script>
        window.onload = function() {
            const dataSelecionada = localStorage.getItem('dataSelecionada');
            const horaSelecionada = localStorage.getItem('horaSelecionada');
            const fotoSelecionada = localStorage.getItem('fotoSelecionada');

            // Verificar se os dados necessários foram passados
            if (!dataSelecionada || !horaSelecionada) {
                alert("Erro ao carregar a data e hora. Tente novamente.");
                return;
            }

            // Exibir no console para debugging
            console.log("Data selecionada: ", dataSelecionada);
            console.log("Hora selecionada: ", horaSelecionada);

            // Formatar a data de forma correta
            const dataHoraFinal = new Date(dataSelecionada + 'T' + horaSelecionada);
            const agora = new Date();

            // Exibir no console a data e hora calculada
            console.log("Data e Hora Final: ", dataHoraFinal);
            console.log("Data e Hora Atual: ", agora);

            // Verificar se a data e hora escolhidas são no futuro
            if (dataHoraFinal <= agora) {
                alert("A data e hora já passaram.");
                return;
            }

            // Função para calcular o tempo restante
            function calcularTempo() {
                const tempoRestante = dataHoraFinal - agora;
                
                // Verificar se tempoRestante é um número válido
                if (isNaN(tempoRestante)) {
                    alert("Erro no cálculo do tempo. Tente novamente.");
                    return;
                }

                const segundos = Math.floor(tempoRestante / 1000);
                const minutos = Math.floor(segundos / 60);
                const horas = Math.floor(minutos / 60);
                const dias = Math.floor(horas / 24);
                const anos = Math.floor(dias / 365);

                const textoContador = `${anos} anos, ${dias % 365} dias, ${horas % 24} horas, ${minutos % 60} minutos, ${segundos % 60} segundos`;
                document.getElementById("contador").textContent = textoContador;
            }

            // Atualizar a cada segundo
            setInterval(calcularTempo, 1000);

            // Exibir a foto, se houver
            if (fotoSelecionada) {
                document.getElementById("fotoImg").src = fotoSelecionada;
            }
        }
    </script>
</body>
</html>
